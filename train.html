

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Train &mdash; ehreact  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Predict" href="predict.html" />
    <link rel="prev" title="Command Line Arguments" href="arguments.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ehreact
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="arguments.html">Command Line Arguments</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Train</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#calculate-diagram">Calculate Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Train</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hasse">Hasse</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="predict.html">Predict</a></li>
<li class="toctree-l2"><a class="reference internal" href="helpers.html">Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="diagram.html">Diagram</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ehreact</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="api.html">API Documentation</a> &raquo;</li>
        
      <li>Train</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/train.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="train">
<h1>Train<a class="headerlink" href="#train" title="Permalink to this headline">¶</a></h1>
<p>ehreact.train contains functions and classes for calculating a Hasse diagram.</p>
<div class="section" id="calculate-diagram">
<h2>Calculate Diagram<a class="headerlink" href="#calculate-diagram" title="Permalink to this headline">¶</a></h2>
<p>Classes and functions from ehreact.train.calculate_diagram.py.</p>
<span class="target" id="module-ehreact.train.calculate_diagram"></span><p>calculate_diagram.py
Training Hasse diagrams.</p>
<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.calculate_diagram.calculate_diagram">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.calculate_diagram.</span></span><span class="sig-name descname"><span class="pre">calculate_diagram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_aam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transition_state'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_only_branches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_dir_img</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/calculate_diagram.html#calculate_diagram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.calculate_diagram.calculate_diagram" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a Hasse diagram of a list of reaction or molecule smiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>List[str]</em>) – List of SMILES or reaction SMILES.</p></li>
<li><p><strong>verbose</strong> (<em>bool, default False</em>) – Whether to print additional information.</p></li>
<li><p><strong>quiet</strong> (<em>bool, default True</em>) – Whether to silence all output.</p></li>
<li><p><strong>compute_aam</strong> (<em>bool, default False</em>) – Whether to compute atom-mappings for reactions.</p></li>
<li><p><strong>save_path</strong> (<em>str, default  None</em>) – File to which diagram is saved.</p></li>
<li><p><strong>save_plot</strong> (<em>str, default  None</em>) – File to which save image of diagram.</p></li>
<li><p><strong>train_mode</strong> (<em>Literal[“single_reactant”,”transition_state”], default “transition_state”</em>) – Train mode, either transition states extracted from reaction smiles or single reactants extracted from smiles.</p></li>
<li><p><strong>seed</strong> (<em>List[str], default []</em>) – List of SMILES seeds for the reactant algorithm, usually a single seed is given.</p></li>
<li><p><strong>no_props</strong> (<em>bool, default False</em>) – Do not compute any properties, just output the diagram.</p></li>
<li><p><strong>plot_only_branches</strong> (<em>bool, default False</em>) – Plot only substructures that branch off.</p></li>
<li><p><strong>temp_dir_img</strong> (<em>str, default None</em>) – Directory to save temporary image files</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>d</strong> – The Hasse diagram of the input list of molecules/reactions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="diagram.html#ehreact.diagram.diagram.Diagram" title="ehreact.diagram.diagram.Diagram">ehreact.diagram.diagram.Diagram</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.calculate_diagram.calculate_diagram_single_reactant">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.calculate_diagram.</span></span><span class="sig-name descname"><span class="pre">calculate_diagram_single_reactant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/calculate_diagram.html#calculate_diagram_single_reactant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.calculate_diagram.calculate_diagram_single_reactant" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a Hasse diagram of a list of molecule smiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>List[str]</em>) – List of SMILES.</p></li>
<li><p><strong>seed_list</strong> (<em>List[str]</em>) – List of SMILES seeds.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print additional information.</p></li>
<li><p><strong>quiet</strong> (<em>bool</em>) – Whether to silence all output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>d</strong> (<em>ehreact.diagram.diagram.Diagram</em>) – The Hasse diagram of the input list of molecules.</p></li>
<li><p><strong>smiles_dict</strong> (<em>dict</em>) – A dictionary of the canonicalized input smiles.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.calculate_diagram.calculate_diagram_transition_state">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.calculate_diagram.</span></span><span class="sig-name descname"><span class="pre">calculate_diagram_transition_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_aam</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/calculate_diagram.html#calculate_diagram_transition_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.calculate_diagram.calculate_diagram_transition_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a Hasse diagram of a list of reaction smiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>List[str]</em>) – List of reaction SMILES.</p></li>
<li><p><strong>verbose</strong> (<em>bool, default False</em>) – Whether to print additional information.</p></li>
<li><p><strong>quiet</strong> (<em>bool</em>) – Whether to silence all output.</p></li>
<li><p><strong>compute_aam</strong> (<em>bool</em>) – Whether to compute atom-mappings for reactions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>d</strong> (<em>ehreact.diagram.diagram.Diagram</em>) – The Hasse diagram of the input list of reactions.</p></li>
<li><p><strong>smiles_dict</strong> (<em>dict</em>) – A dictionary of the canonicalized input smiles.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.calculate_diagram.calculate_diversity">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.calculate_diagram.</span></span><span class="sig-name descname"><span class="pre">calculate_diversity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stereo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/calculate_diagram.html#calculate_diversity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.calculate_diagram.calculate_diversity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates diversity within a branch or tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>ehreact.diagram.diagram.Diagram</em>) – Hasse diagram.</p></li>
<li><p><strong>node</strong> (<em>ehreact.diagram.diagram.Node</em>) – Node for which to calculate diversity, all leaf nodes attached to this node by an arbitrary number of
edges toward children are taken into account.</p></li>
<li><p><strong>stereo</strong> (<em>bool</em>) – Whether to include stereochemistry in fingerprints</p></li>
<li><p><strong>train_mode</strong> (<em>Literal[“single_reactant”, “transition_state”]</em>) – Train mode, either transition states extracted from reaction smiles or single reactants extracted from smiles.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mean_div_reac</strong> (<em>float</em>) – Mean pair similarity of reactants.</p></li>
<li><p><strong>mean_div_prod</strong> (<em>float</em>) – Mean pair similarity of products.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.calculate_diagram.fill_information">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.calculate_diagram.</span></span><span class="sig-name descname"><span class="pre">fill_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/calculate_diagram.html#fill_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.calculate_diagram.fill_information" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to fill topology information and fingerprints into a Hasse diagram (alters diagram in-place).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>ehreact.diagram.diagram.Diagram</em>) – Hasse diagram.</p></li>
<li><p><strong>train_mode</strong> (<em>Literal[“single_reactant”,”transition_state”]</em>) – Train mode, either transition states extracted from reaction smiles or single reactants extracted from smiles.</p></li>
<li><p><strong>verbose</strong> (<em>bool, default False</em>) – Whether to print additional information.</p></li>
<li><p><strong>smiles_dict</strong> (<em>dict</em>) – A dictionary of the canonicalized input smiles.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.calculate_diagram.find_lowest_template">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.calculate_diagram.</span></span><span class="sig-name descname"><span class="pre">find_lowest_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/calculate_diagram.html#find_lowest_template"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.calculate_diagram.find_lowest_template" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to find the lowest (most general) substructure/reaction rule in the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>curr_node</strong> (<em>ehreact.diagram.diagram.Node</em>) – Node for which to find the lowest template.</p></li>
<li><p><strong>d</strong> (<em>ehreact.diagram.diagram.Diagram</em>) – Hasse diagram.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>lowest_template</strong> – Name of the lowest template.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.calculate_diagram.write_fragment_list_to_root">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.calculate_diagram.</span></span><span class="sig-name descname"><span class="pre">write_fragment_list_to_root</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/calculate_diagram.html#write_fragment_list_to_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.calculate_diagram.write_fragment_list_to_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to calculate a list of reactant rule fragments (only atoms in reaction center). This in needed
to transform inputted molecules to their corresponding transition state. Save to the root node (in-place).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>ehreact.diagram.diagram.Diagram</em>) – Hasse diagram.</p></li>
<li><p><strong>train_mode</strong> (<em>Literal[“single_reactant”,”transition_state”]</em>) – Train mode, either transition states extracted from reaction smiles or single reactants extracted from smiles.</p></li>
<li><p><strong>verbose</strong> (<em>bool, default False</em>) – Whether to print additional information.</p></li>
<li><p><strong>smiles_dict</strong> (<em>dict</em>) – A dictionary of the canonicalized input smiles.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id1">
<h2>Train<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Classes and functions from ehreact.train.train.py</p>
<span class="target" id="module-ehreact.train.train"></span><p>train.py
Entry point for training Hasse diagrams.</p>
<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.train.train">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.train.</span></span><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/train.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.train.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a Hasse diagram based on the inputted arguments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>Namespace</em>) – Namespace of arguments.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="hasse">
<h2>Hasse<a class="headerlink" href="#hasse" title="Permalink to this headline">¶</a></h2>
<p>Classes and functions from ehreact.train.hasse.py</p>
<span class="target" id="module-ehreact.train.hasse"></span><dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.hasse.check_one_extension">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.hasse.</span></span><span class="sig-name descname"><span class="pre">check_one_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pivot_rule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_possible_rules</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/hasse.html#check_one_extension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.hasse.check_one_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to iterate over all current molecules/pseudomolecules and check whether each of them
allows for an extension resulting in the current pivot_rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pivot_rule</strong> (<em>RDKit.Chem.Mol</em>) – A possible new template</p></li>
<li><p><strong>max_possible_rules</strong> (<em>dict</em>) – A dictionary of the matching atoms and possible new templates for all molecules/pseudomolecules.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether or not the pivot rule has a substructure match with any of the possible extensions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.hasse.enlarge_rule">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.hasse.</span></span><span class="sig-name descname"><span class="pre">enlarge_rule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/hasse.html#enlarge_rule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.hasse.enlarge_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to look for possible atoms to add to current template, find best combination,
and create a new template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rule</strong> (<em>rdkit.Chem.Mol</em>) – RDKit molecule object of the current template (molecule or pseudomolecule).</p></li>
<li><p><strong>mols</strong> (<em>List[rdkit.Chem.Mol]</em>) – List of RDKit molecule objects of the molecules or pseudomolecules which are considered in the current branch.</p></li>
<li><p><strong>smiles</strong> (<em>List[str]</em>) – List of SMILES strings of the molecules or pseudomolecules which are considered in the current branch.</p></li>
<li><p><strong>change_dict</strong> (<em>dict</em>) – A dictionary of all changes upon going from reactants to products.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print additional information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_rules</strong> – A dictionary of new templates (childs to the current node), might be one or multiple templates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.hasse.extend_by_atom">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.hasse.</span></span><span class="sig-name descname"><span class="pre">extend_by_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ring_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/hasse.html#extend_by_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.hasse.extend_by_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Extends the current rule (‘patt’) by adding neighbours of the atoms specified in the list of
atom indices ‘idx_list’ according to the molecule ‘m’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patt</strong> (<em>rdkit.Chem.Mol</em>) – RDKit molecule object of the current template (molecule or pseudomolecule).</p></li>
<li><p><strong>n</strong> (<em>rdkit.Chem.Mol</em>) – RDKit molecule object of the current leaf node.</p></li>
<li><p><strong>match</strong> (<em>tuple</em>) – Tuple of matching atom indices of the current rule.</p></li>
<li><p><strong>idx_list</strong> (<em>list</em>) – List of atom indices at which to extend the pattern.</p></li>
<li><p><strong>ring_extension</strong> (<em>bool</em>) – Boolean whether current iteration has broken a ring and must thus be iterated until full ring is found.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_patt</strong> – RDKit molecule object of the new, extended template (molecule or pseudomolecule).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rdkit.Chem.Mol</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>For the molecule CCOCO, the rule CCO matches the first three atoms and can be extended at atom 2 (the oxygen),
yielding the new, extended molecule CCOC:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CCO&quot;</span><span class="p">,</span><span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_rule</span><span class="o">=</span><span class="n">extend_by_atom</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CCOCO&quot;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">new_rule</span><span class="p">))</span>
<span class="go">&#39;COCC&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.hasse.extend_by_single_match">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.hasse.</span></span><span class="sig-name descname"><span class="pre">extend_by_single_match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">possible_extensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_possible_rules</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/hasse.html#extend_by_single_match"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.hasse.extend_by_single_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Enlarges the current template by selecting the best extensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>possible_extensions</strong> (<em>dict</em>) – A dictionary of possible extensions for each input molecule, containing the matching indices, atom indices of
atoms to extend, and their possible extension as string.</p></li>
<li><p><strong>match</strong> (<em>tuple</em>) – Tuple of the matching atom indices for the pivot molecule.</p></li>
<li><p><strong>idx</strong> (<em>str</em>) – Index of pivot molecule.</p></li>
<li><p><strong>mols</strong> (<em>List[rdkit.Chem.Mol]</em>) – List of RDKit molecule objects of the molecules or pseudomolecules which are considered in the current branch.</p></li>
<li><p><strong>smiles</strong> (<em>List[str]</em>) – List of SMILES strings of the molecules or pseudomolecules which are considered in the current branch.</p></li>
<li><p><strong>rule</strong> (<em>rdkit.Chem.Mol</em>) – RDKit molecule object of the current template (molecule or pseudomolecule).</p></li>
<li><p><strong>change_dict</strong> (<em>dict</em>) – A dictionary of all changes upon going from reactants to products.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print additional information.</p></li>
<li><p><strong>max_possible_rules</strong> (<em>dict</em>) – Dictionary of possibly extensions, containing the atoms indices of the matching atoms, as well as all
the possible enlarged templates as string and RDKit molecule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_patterns</strong> – Dictionary of new templates, to be attached to current node as children, including list of molecules and smiles
belonging to each new template.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smis</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CCOCO&quot;</span><span class="p">,</span> <span class="s2">&quot;CCOOC&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span> <span class="k">for</span> <span class="n">smi</span> <span class="ow">in</span> <span class="n">smis</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CCO&quot;</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">possible_extensions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CCOCO&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;OC&#39;</span><span class="p">}},</span> <span class="s1">&#39;CCOOC&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;OO&#39;</span><span class="p">}}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">change_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;reac&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;atom&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;bond&quot;</span><span class="p">:</span> <span class="p">{}},</span> <span class="s2">&quot;prod&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;atom&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;bond&quot;</span><span class="p">:</span> <span class="p">{}}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_possible_rules</span><span class="o">=</span><span class="n">get_max_possible_rules</span><span class="p">(</span><span class="n">possible_extensions</span><span class="p">,</span><span class="n">rule</span><span class="p">,</span><span class="n">mols</span><span class="p">,</span><span class="n">change_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extend_by_single_match</span><span class="p">(</span><span class="n">possible_extensions</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">mols</span><span class="p">,</span><span class="n">smis</span><span class="p">,</span><span class="n">rule</span><span class="p">,</span><span class="n">change_dict</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="n">max_possible_rules</span><span class="p">)</span>
<span class="go">{&#39;COCC&#39;: {&#39;rule&#39;: &lt;rdkit.Chem.rdchem.Mol at 0x7ffc4d7592b0&gt;,</span>
<span class="go">          &#39;mols&#39;: [&lt;rdkit.Chem.rdchem.Mol at 0x7ffc4d75eda0&gt;], &#39;smiles&#39;: [&#39;CCOCO&#39;]},</span>
<span class="go"> &#39;CCOO&#39;: {&#39;rule&#39;: &lt;rdkit.Chem.rdchem.Mol at 0x7ffc4d759f30&gt;,</span>
<span class="go">          &#39;mols&#39;: [&lt;rdkit.Chem.rdchem.Mol at 0x7ffc4d75e1c0&gt;], &#39;smiles&#39;: [&#39;CCOOC&#39;]}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.hasse.extended_hasse">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.hasse.</span></span><span class="sig-name descname"><span class="pre">extended_hasse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rule_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags_core</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/hasse.html#extended_hasse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.hasse.extended_hasse" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an extended Hasse diagram.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_dict</strong> (<em>dict</em>) – A dictionary of the canonicalized input smiles.</p></li>
<li><p><strong>seeds</strong> (<em>List[str]</em>) – List of SMILES seeds.</p></li>
<li><p><strong>rule_dict</strong> (<em>dict</em>) – A dictionary of all minimal templates of all seeds.</p></li>
<li><p><strong>tags_core</strong> (<em>dict</em>) – A dictionary of the atom map numbers for each minimal template. Empty dictionary for single reactant mode.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print additional information.</p></li>
<li><p><strong>quiet</strong> (<em>bool</em>) – Whether to silence all output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>d</strong> – The Hasse diagram of the input list of molecules.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="diagram.html#ehreact.diagram.diagram.Diagram" title="ehreact.diagram.diagram.Diagram">ehreact.diagram.diagram.Diagram</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.hasse.get_max_possible_rules">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.hasse.</span></span><span class="sig-name descname"><span class="pre">get_max_possible_rules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">possible_extensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/hasse.html#get_max_possible_rules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.hasse.get_max_possible_rules" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a dictionary of possible extensions and computes the corresponding enlarged templates as
RDKit molecule objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>possible_extensions</strong> (<em>dict</em>) – A dictionary of possible extensions for each input molecule, containing the matching indices,
atom indices of atoms to extend, and their possible extension as string.</p></li>
<li><p><strong>rule</strong> (<em>rdkit.Chem.Mol</em>) – RDKit molecule object of the current template (molecule or pseudomolecule).</p></li>
<li><p><strong>mols</strong> (<em>List[rdkit.Chem.Mol]</em>) – List of RDKit molecule objects of the molecules or pseudomolecules which are considered in the current branch.</p></li>
<li><p><strong>change_dict</strong> (<em>dict</em>) – A dictionary of all changes upon going from reactants to products.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>extension_dict</strong> – Dictionary of possibly extensions, containing the atoms indices of the matching atoms, as well as all the
possible enlarged templates as string and RDKit molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smis</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CCOCO&quot;</span><span class="p">,</span> <span class="s2">&quot;CCOOC&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span> <span class="k">for</span> <span class="n">smi</span> <span class="ow">in</span> <span class="n">smis</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CCO&quot;</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">possible_extensions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CCOCO&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;OC&#39;</span><span class="p">}},</span> <span class="s1">&#39;CCOOC&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;OO&#39;</span><span class="p">}}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">change_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;reac&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;atom&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;bond&quot;</span><span class="p">:</span> <span class="p">{}},</span> <span class="s2">&quot;prod&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;atom&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;bond&quot;</span><span class="p">:</span> <span class="p">{}}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_max_possible_rules</span><span class="p">(</span><span class="n">possible_extensions</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="n">mols</span><span class="p">,</span> <span class="n">change_dict</span><span class="p">)</span>
<span class="go">{&#39;CCOCO&#39;: {(0, 1, 2): {&#39;COCC&#39;: &lt;rdkit.Chem.rdchem.Mol at 0x7ffc4d75bee0&gt;}},</span>
<span class="go"> &#39;CCOOC&#39;: {(0, 1, 2): {&#39;CCOO&#39;: &lt;rdkit.Chem.rdchem.Mol at 0x7ffc4d75b4e0&gt;}}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.hasse.get_possible_extensions">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.hasse.</span></span><span class="sig-name descname"><span class="pre">get_possible_extensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/hasse.html#get_possible_extensions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.hasse.get_possible_extensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches for all possible extensions of a template taking into account a list of molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rule</strong> (<em>rdkit.Chem.Mol</em>) – RDKit molecule object of the current template (molecule or pseudomolecule).</p></li>
<li><p><strong>mols</strong> (<em>List[rdkit.Chem.Mol]</em>) – List of RDKit molecule objects of the molecules or pseudomolecules which are considered in the current branch.</p></li>
<li><p><strong>smiles</strong> (<em>List[str]</em>) – List of SMILES strings of the molecules or pseudomolecules which are considered in the current branch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>extension_dict</strong> – A dictionary of possible extensions for each input molecule, containing the matching indices, atom indices
of atoms to extend, and their possible extension as string.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>For the molecules CCOCO and CCOOC, the rule CCO matches both molecules, and allows for one possible extension at
the oxygen, adding a carbon for the first molecule, or an oxygen for the second molecule:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smis</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CCOCO&quot;</span><span class="p">,</span> <span class="s2">&quot;CCOOC&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span> <span class="k">for</span> <span class="n">smi</span> <span class="ow">in</span> <span class="n">smis</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CCO&quot;</span><span class="p">,</span><span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_possible_extensions</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span><span class="n">mols</span><span class="p">,</span><span class="n">smis</span><span class="p">)</span>
<span class="go">{&#39;CCOCO&#39;: {(0, 1, 2): {2: &#39;OC&#39;}}, &#39;CCOOC&#39;: {(0, 1, 2): {2: &#39;OO&#39;}}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.hasse.has_one_extension">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.hasse.</span></span><span class="sig-name descname"><span class="pre">has_one_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pivot_rule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extensions_all_matches</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/hasse.html#has_one_extension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.hasse.has_one_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to check whether any current template match and corresponding extension results
in the current pivot_rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pivot_rule</strong> (<em>RDKit.Chem.Mol</em>) – A possible new template</p></li>
<li><p><strong>extensions_all_matches</strong> (<em>dict</em>) – A dictionary of matching atoms and possible new templates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether or not the pivot rule has a substructure match with any of the possible extensions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.hasse.iterate_algorithm">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.hasse.</span></span><span class="sig-name descname"><span class="pre">iterate_algorithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rule_smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags_core</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/hasse.html#iterate_algorithm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.hasse.iterate_algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate atom extension algorithm by looking for possible atoms to add to, find best combination,
create a new template and attach it to the current Hasse diagram (edits to diagram are in-place).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>ehreact.diagram.diagram.Diagram</em>) – The current Hasse diagram.</p></li>
<li><p><strong>mols</strong> (<em>List[rdkit.Chem.Mol]</em>) – List of RDKit molecule objects of the molecules or pseudomolecules which are considered in the current branch.</p></li>
<li><p><strong>smiles</strong> (<em>List[str]</em>) – List of SMILES strings of the molecules or pseudomolecules which are considered in the current branch.</p></li>
<li><p><strong>rule</strong> (<em>rdkit.Chem.Mol</em>) – RDKit molecule object of the current template (molecule or pseudomolecule).</p></li>
<li><p><strong>rule_smiles</strong> (<em>str</em>) – Name of the current template.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print additional information.</p></li>
<li><p><strong>quiet</strong> (<em>bool</em>) – Whether to silence all output.</p></li>
<li><p><strong>change_dict</strong> (<em>dict</em>) – A dictionary of all changes upon going from reactants to products.</p></li>
<li><p><strong>tags_core</strong> (<em>dict</em>) – A dictionary of the atom map numbers for each minimal template. Empty dictionary for single reactant mode.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ehreact.train.hasse.quick_match">
<span class="sig-prename descclassname"><span class="pre">ehreact.train.hasse.</span></span><span class="sig-name descname"><span class="pre">quick_match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol_small</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_large</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ehreact/train/hasse.html#quick_match"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ehreact.train.hasse.quick_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes whether mol_small could possibly be a subgraph of mol_large based on atom type counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol_small</strong> (<em>RDKit.Chem.Mol</em>) – A molecule.</p></li>
<li><p><strong>mol_large</strong> (<em>RDKit.Chem.Mol</em>) – A molecule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether a subgraph match is possible based on atom type counts.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="predict.html" class="btn btn-neutral float-right" title="Predict" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="arguments.html" class="btn btn-neutral float-left" title="Command Line Arguments" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Esther Heid. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.5.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>